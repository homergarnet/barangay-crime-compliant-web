<!-- bg-gradient-danger put this if you want nice background -->
<div class="header pb-8 pt-5 pt-md-8">
  <div class="container-fluid">
    <div class="row">
      <div
        id="exampleModalCenter"
        class="modal fade {{
          this.isModalShow == true ? 'show display-modal' : 'hide-modal'
        }}"
        tabindex="-1"
        role="dialog"
        aria-labelledby="exampleModalCenterTitle"
      >
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalCenterTitle">
                {{ modalTitle }}
              </h5>
              <button
                type="button"
                class="close"
                (click)="showHideModal('', false)"
                data-dismiss="modal"
                aria-label="Close"
              >
                <span aria-hidden="true">Ã—</span>
              </button>
            </div>
            <div class="modal-body scrollable-div">
              <!-- Design 1 -->
              <ng-template #edit>
                <form [formGroup]="receivedCrimeForm">
                  <div class="row mb-2">
                    <div class="col">
                      <label for="responderName" class="mb-1">Responder</label>
                      <ng-autocomplete
                        formControlName="responderName"
                        [data]="responderData"
                        [searchKeyword]="keyword"
                        placeholder="Select Responder"
                        (selected)="selectEvent($event)"
                        (inputChanged)="onChangeSearch($event)"
                        (inputFocused)="onFocused($event)"
                        [itemTemplate]="itemTemplate"
                        [notFoundTemplate]="notFoundTemplate"
                      >
                      </ng-autocomplete>

                      <ng-template #itemTemplate let-item>
                        <a [innerHTML]="item.name"></a>
                      </ng-template>

                      <ng-template #notFoundTemplate let-notFound>
                        <div [innerHTML]="notFound"></div>
                      </ng-template>
                    </div>
                  </div>
                  <ng-container
                    *ngIf="isAddnewDescription"
                    formArrayName="responderDescription"
                  >
                    <div
                      class="row mb-2"
                      *ngFor="
                        let control of receivedCrimeForm.get(
                          'responderDescription'
                        )['controls'];
                        let i = index
                      "
                      [formGroupName]="i"
                    >
                      <div class="col">
                        <label for="description{{ i }}" class="mb-1"
                          >Description</label
                        >
                        <textarea
                          id="description{{ i }}"
                          class="form-control"
                          formControlName="responderDescriptionTxt"
                        ></textarea>
                        <div
                          *ngIf="
                            responderDescription.controls[i].get(
                              'responderDescriptionTxt'
                            ).invalid &&
                            (responderDescription.controls[i].get(
                              'responderDescriptionTxt'
                            ).dirty ||
                              responderDescription.controls[i].get(
                                'responderDescriptionTxt'
                              ).touched ||
                              submitted)
                          "
                          class="text-danger"
                        >
                          <div
                            *ngIf="
                              responderDescription.controls[i]
                                .get('responderDescriptionTxt')
                                .hasError('required')
                            "
                          >
                            * Responder Description is required.
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-container>

                  <div class="row mb-2" *ngIf="isAddnewDescription">
                    <div class="col">
                      <button
                        class="btn btn-primary"
                        type="button"
                        (click)="addResponderDescriptionField()"
                      >
                        Add new Description
                      </button>
                    </div>
                  </div>
                  <div class="row mb-2">
                    <div class="col">
                      <label for="status" class="mb-1">Status</label>
                      <select
                        id="status"
                        class="form-control"
                        formControlName="status"
                      >
                        <option
                          *ngFor="let status of statusValue"
                          value="{{ status.value }}"
                        >
                          {{ status.name }}
                        </option>
                      </select>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col">
                      <button
                        class="btn btn-primary col-12"
                        type="button"
                        (click)="updateCrimeStatus()"
                      >
                        Update
                      </button>
                    </div>
                  </div>
                </form>
              </ng-template>
              <!-- Design 2 -->
              <ng-template #viewDetails>
                <div class="row">
                  <div class="col text-center">
                    <!-- <h2>Images</h2>


                    <h2>Videos</h2> -->
                    <ng-container *ngFor="let image of crimeImageByIdList">
                      <img
                        class="img-fluid mb-2"
                        [src]="API_URL + image.Image"
                      />
                    </ng-container>
                    <ng-container *ngFor="let video of crimeVideoByIdList">
                      <video
                        class="width-100-p img-asset-media-height mb-2"
                        [src]="API_URL + video.Image"
                        controls
                      >
                        Your browser does not support the video tag.
                      </video>
                    </ng-container>
                  </div>
                </div>
              </ng-template>

              <!-- Display the selected design -->
              <ng-container
                *ngTemplateOutlet="showEdit ? edit : viewDetails"
              ></ng-container>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                (click)="showHideModal('', false)"
                data-dismiss="modal"
              >
                Close
              </button>
              <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-xl-12 mb-5 mb-xl-0">
        <div class="card shadow">
          <div class="card-header border-0">
            <div class="row align-items-center">
              <div class="col">
                <h1 class="">Manage Crime</h1>
                <!-- <img class="license_icon" [src]="imageLink" /> -->
              </div>
              <div class="col">
                <select
                  id="status"
                  class="form-control"
                  (change)="applyFilter($event)"
                >
                  <option value="" selected>none</option>
                  <option value="active">active</option>
                  <option value="fake report">fake report</option>
                  <option value="resolved">resolved</option>
                  <option value="in progress">in progress</option>
                  <option value="investigation">investigation</option>
                  <option value="completed">completed</option>
                  <option value="closed">closed</option>
                </select>
              </div>

              <div class="col">
                <!-- <a href="#!" class="btn btn-sm btn-primary">See all</a> -->
                <input
                  class="form-control"
                  type="search"
                  placeholder="Search"
                  (keyup)="applyFilter($event)"
                />
              </div>
            </div>
          </div>
          <div class="table-responsive">
            <!-- Projects table -->
            <table class="table align-items-center table-flush">
              <thead class="thead-light">
                <tr>
                  <th scope="col">Report ID</th>
                  <th scope="col">Date</th>
                  <th scope="col">Time</th>
                  <th scope="col">Location</th>
                  <th scope="col">Category</th>
                  <th scope="col">Description</th>
                  <th scope="col">Reporter Name</th>
                  <th scope="col">Reporter Contact</th>
                  <th scope="col">Status</th>
                  <th scope="col">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let data of receiveCrimeFilteredList">
                  <th scope="row">CR-2023 {{ data.ReportIdStr }}</th>
                  <td>{{ data.Date | date : "yyyy-MM-dd" }}</td>
                  <td>{{ data.Time }}</td>
                  <td>
                    <!-- <i class="fas fa-arrow-up text-success mr-3"></i>  -->
                    Lat: {{ data.Lat }} Long: {{ data.Long }}
                  </td>
                  <td>{{ data.Category }}</td>
                  <td>{{ data.Description }}</td>
                  <td>{{ data.ReporterName }}</td>
                  <td>{{ data.ReporterContact }}</td>
                  <td>{{ data.Status }}</td>

                  <td>
                    <button
                      class="btn btn-primary mr-2"
                      type="button"
                      (click)="
                        showHideModal(
                          'Edit',
                          true,
                          data.ReportId,
                          data.ResponderId,
                          data.ResponderName,
                          data.ResponderDescription,
                          data.Status
                        )
                      "
                    >
                      Edit
                    </button>
                    <button
                      class="btn btn-success"
                      type="button"
                      (click)="
                        showHideModal('View Details', false, data.ReportId)
                      "
                    >
                      View Details
                    </button>
                    <button
                      class="btn btn-secondary"
                      type="button"
                      (click)="generatePDF()"
                    >
                      Download as Pdf
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div class="row mb-2">
      <div class="col">
        <nav aria-label="Page navigation example">
          <ul class="pagination justify-content-center">
            <li class="page-item">
              <a class="page-link btn" (click)="onMinusCurrentPage()">Prev</a>
            </li>
            <li
              class="page-item"
              *ngFor="let numberOfPagesArr of numberOfPagesArr; let i = index"
            >
              <a class="page-link btn" (click)="onClickcurrentPage(i + 1)">{{
                i + 1
              }}</a>
            </li>
            <li class="page-item">
              <a
                class="page-link btn"
                (click)="onAddCurrentPage()"
                *ngIf="numberOfPages != 0"
                >Next</a
              >
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>
<ng-template
  #formError
  let-control="control"
  let-message="message"
  let-validation="validation"
>
  <ng-container
    *ngIf="control.hasError(validation) && (control.dirty || control.touched)"
  >
    <div class="fv-plugins-message-container">
      <div class="fv-help-block">
        <span class="text-danger">{{ message }}</span>
      </div>
    </div>
  </ng-container>
</ng-template>
